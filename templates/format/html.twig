{% extends "layout.twig" %}

{% block container %}
    <h3 class="page-header">html在线美化压缩</h3>

    <p class="text-muted">
        待格式化html代码：
        {{ Bootstrap.iconBtn('copy', {'data-obj':'#origin_textarea'})|raw }}
        {{ Bootstrap.iconBtn('remove', {'data-obj':'#origin_textarea'})|raw }}
    </p>
    {{ Bootstrap.textarea('origin_textarea', 10, test)|raw }}
    <div style="margin: 10px 0px;"></div>
    <div class="text-center">
        {{ Bootstrap.button({'id':'submit', 'data-obj':'#origin_textarea|#result_textarea'}, 'html格式化&美化')|raw }}
        {{ Bootstrap.button({'id':'resubmit', 'data-obj':'#origin_textarea|#result_textarea'}, '压缩html')|raw }}
    </div>
    <p class="text-muted">
        格式化化之后的html代码：
        {{ Bootstrap.iconBtn('copy', {'data-obj':'#result_textarea'})|raw }}
        {{ Bootstrap.iconBtn('remove', {'data-obj':'#result_textarea'})|raw }}
        {{ Bootstrap.iconBtn('retweet', {'data-obj':'#origin_textarea|#result_textarea'})|raw }}
    </p>
    {#{{ Bootstrap.textarea('result_textarea')|raw }}#}
    <pre><div class="well" id="result_textarea"></div></pre>


{% endblock %}

{% block script %}
    <script type="text/javascript">
        var htmlOpt = {
            "allowed_file_extensions": ["htm", "html", "xhtml", "shtml", "xml", "svg","aspx","jsp"],
            "brace_style": "collapse", // [collapse|expand|end-expand|none] Put braces on the same line as control statements (default), or put braces on own line (Allman / ANSI style), or just put end braces on own line, or attempt to keep them where they are
            "end_with_newline": false, // End output with newline
            "indent_char": "\t", // Indentation character
            "indent_handlebars": false, // e.g.
            "indent_inner_html": false, // Indent <head> and <body> sections
            "indent_scripts": "keep", // [keep|separate|normal]
            "indent_size": 1, // Indentation size
            "max_preserve_newlines": 10, // Maximum number of line breaks to be preserved in one chunk (0 disables)
            "preserve_newlines": true, // Whether existing line breaks before elements should be preserved (only works before elements, not inside tags or for text)
            "unformatted": ["a", "span", "img", "code", "pre", "sub", "sup", "em", "strong", "b", "i", "u", "strike", "big", "small", "pre", "h1", "h2", "h3", "h4", "h5", "h6"], // List of tags that should not be reformatted
            "wrap_line_length": 0 // Lines should wrap at next opportunity after this number of characters (0 disables)
        };

        $('#submit').click(function () {
            var obj = $(this).data('obj');
            var arr = obj.split('|');
            if (arr.length != 2){
                console.log('submit operation arr error', obj);
                return false;
            }
            $(arr[1]).text(html_beautify($(arr[0]).val(), {
                "brace_style": "collapse",
                "collapse": true,
                "end_with_newline": true,
                "indent_char": "\t", // Indentation character
                "indent_size": 1, // Indentation size
            }));
        });

        $('#resubmit').click(function () {
            var obj = $(this).data('obj');
            var arr = obj.split('|');
            if (arr.length != 2){
                console.log('submit operation arr error', obj);
                return false;
            }
            $(arr[1]).text(utils.htmlCompress($(arr[0]).val()));
        });
    </script>
{% endblock %}