{% extends "layout.twig" %}

{% block container %}
    <h3 class="page-header">在线Json格式化、在线格式化Json代码、Json代码美化器、Json在线压缩、Json \uxxxx格式解码</h3>

    {#<blockquote>
        <p>Json代码进行美化、格式化、检查Json错误。 也可以进行Json代码压缩处理,提供Json Unicode转换为对应字符！！将json \uxxxx类，格式化相应的中文字符串！Json</p>
    </blockquote>#}
    <div class="well">
        Json代码进行美化、格式化、检查Json错误。 也可以进行Json代码压缩处理,提供Json Unicode转换为对应字符！！将json \uxxxx类，格式化相应的中文字符串！Json
    </div>
    <p class="text-muted">
        待格式化JSON代码：
        {{ Bootstrap.iconBtn('copy', {'data-obj':'#origin_textarea'})|raw }}
        {{ Bootstrap.iconBtn('remove', {'data-obj':'#origin_textarea'})|raw }}
    </p>
    {{ Bootstrap.textarea('origin_textarea')|raw }}
    <div style="margin: 10px 0px;"></div>
    <div class="text-center">
        {{ Bootstrap.button({'id':'submit', 'data-obj':'#origin_textarea|#result_textarea'}, 'JSON格式化&美化')|raw }}
        {{ Bootstrap.button({'id':'resubmit', 'data-obj':'#origin_textarea|#result_textarea'}, '检查&压缩JSON')|raw }}
    </div>
    <p class="text-muted">
        格式化化之后的JSON代码：
        {{ Bootstrap.iconBtn('copy', {'data-obj':'#result_textarea'})|raw }}
        {{ Bootstrap.iconBtn('remove', {'data-obj':'#result_textarea'})|raw }}
        {{ Bootstrap.iconBtn('retweet', {'data-obj':'#origin_textarea|#result_textarea'})|raw }}
    </p>
    {{ Bootstrap.textarea('result_textarea')|raw }}


{% endblock %}

{% block script %}
    <script type="text/javascript">
        $('#submit').click(function () {
            var obj = $(this).data('obj');
            if (!obj) {
                console.log('submit operation obj error', obj);
                return false;
            }
            var arr = obj.split('|');
            if (arr.length != 2){
                console.log('submit operation arr error', obj);
                return false;
            }
            $.post(
                '/api/format',
                {'type':'json', 'action':'format', 'data':$(arr[0]).val()},
                function (res) {
                    if (res.errCode == 0) {
                        $(arr[1]).val(res.data.result);
                    }else {
                        swal(res.errMsg);
                    }
                },
                'json'
            );
        });
        
        $('#resubmit').click(function () {
            var obj = $(this).data('obj');
            if (!obj) {
                console.log('submit operation obj error', obj);
                return false;
            }
            var arr = obj.split('|');
            if (arr.length != 2){
                console.log('submit operation arr error', obj);
                return false;
            }
            $.post(
                '/api/format',
                {'type':'json', 'action':'compress', 'data':$(arr[0]).val()},
                function (res) {
                    if (res.errCode == 0) {
                        $(arr[1]).val(res.data.result);
                    }else {
                        swal(res.errMsg);
                    }
                },
                'json'
            );
        });
    </script>
{% endblock %}